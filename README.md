# Документация по микросервису аутентификации API

## Обзор

Микросервис аутентификации — это RESTful API сервис для обработки аутентификации пользователей и управления ими. Он предоставляет функционал регистрации, входа и управления информацией о пользователях.

### Основная информация

- **Версия API**: 1.0
- **Базовый путь**: `/api`
- **Способ аутентификации**: Bearer Token (JWT)
- **Техническая поддержка**: support@example.com
- **Лицензия**: Apache 2.0

### Быстрый старт

1. Сначала создайте учетную запись пользователя через endpoint регистрации
2. Используйте endpoint входа для получения JWT токена
3. Добавьте в заголовки последующих запросов: `Authorization: Bearer <ваш_токен>`

## API Endpoints

### Управление аутентификацией

#### Регистрация пользователя
**POST** `/api/auth/register`

Создание новой учетной записи пользователя.

**Тело запроса**:
```json
{
  "username": "string (3-50 символов)",
  "email": "string",
  "password": "string (минимум 6 символов)",
  "fullName": "string (опционально)",
  "phone": "string (опционально)"
}
```

**Ответы**:
- `200`: Успешная регистрация
- `400`: Неверные параметры запроса
- `409`: Имя пользователя или email уже существует

#### Вход пользователя
**POST** `/api/auth/login`

Проверка учетных данных пользователя и возврат JWT токена.

**Тело запроса**:
```json
{
  "username": "string",
  "password": "string"
}
```

**Ответы**:
- `200`: Успешный вход, возвращает JWT токен
- `400`: Неверные параметры запроса
- `401`: Неверное имя пользователя или пароль

### Управление пользователями

#### Получение списка всех пользователей
**GET** `/api/users`

Получение списка всех пользователей в системе.

**Требуемые права**: Администратор

**Ответы**:
- `200`: Успешное получение, возвращает список пользователей
- `401`: Не аутентифицирован
- `403`: Нет прав администратора

#### Получение информации о текущем пользователе
**GET** `/api/users/me`

Получение подробной информации о текущем аутентифицированном пользователе.

**Требуется аутентификация**: Bearer Token

**Ответы**:
- `200`: Успешное получение, возвращает информацию о пользователе
- `401`: Не аутентифицирован

#### Получение информации о пользователе по ID
**GET** `/api/users/{id}`

Получение подробной информации о конкретном пользователе по его ID.

**Параметры пути**:
- `id`: ID пользователя (целое число)

**Ответы**:
- `200`: Успешное получение, возвращает информацию о пользователе
- `401`: Не аутентифицирован
- `404`: Пользователь не найден

#### Обновление информации о пользователе
**PUT** `/api/users/{id}`

Обновление информации о конкретном пользователе.

**Требуемые права**: Администратор

**Параметры пути**:
- `id`: ID пользователя (целое число)

**Тело запроса**:
```json
{
  "email": "string (опционально)",
  "fullName": "string (0-100 символов, опционально)",
  "phone": "string (опционально)",
  "role": "string (опционально)",
  "status": "string (опционально)"
}
```

**Ответы**:
- `200`: Успешное обновление
- `400`: Неверные параметры запроса
- `401`: Не аутентифицирован
- `403`: Нет прав администратора
- `404`: Пользователь не найден

#### Переключение статуса пользователя
**PATCH** `/api/users/{id}/status`

Отключение или включение конкретного пользователя.

**Требуемые права**: Администратор

**Параметры пути**:
- `id`: ID пользователя (целое число)

**Ответы**:
- `200`: Успешное переключение статуса
- `401`: Не аутентифицирован
- `403`: Нет прав администратора
- `404`: Пользователь не найден

#### Удаление пользователя
**DELETE** `/api/users/{id}`

Удаление конкретного пользователя.

**Требуемые права**: Администратор

**Параметры пути**:
- `id`: ID пользователя (целое число)

**Ответы**:
- `200`: Успешное удаление
- `401`: Не аутентифицирован
- `403`: Нет прав администратора
- `404`: Пользователь не найден

## Модели данных

### RegisterDto (Данные регистрации)
```json
{
  "username": "string (обязательно, 3-50 символов)",
  "email": "string (обязательно)",
  "password": "string (обязательно, минимум 6 символов)",
  "fullName": "string (опционально)",
  "phone": "string (опционально)"
}
```

### LoginDto (Данные входа)
```json
{
  "username": "string (обязательно)",
  "password": "string (обязательно)"
}
```

### UserUpdateDto (Данные обновления пользователя)
```json
{
  "email": "string (опционально)",
  "fullName": "string (опционально, 0-100 символов)",
  "phone": "string (опционально)",
  "role": "string (опционально)",
  "status": "string (опционально)"
}
```

## Безопасность и аутентификация

### JWT Bearer Token аутентификация
- **Тип аутентификации**: Bearer Token
- **Формат**: JWT
- **Способ использования**: Добавить в HTTP заголовки:
  ```
  Authorization: Bearer <ваш_jwt_токен>
  ```

## Обработка ошибок

API использует стандартные HTTP коды состояния для отображения результатов запросов:

- `200`: Успешный запрос
- `400`: Ошибка в параметрах запроса
- `401`: Не аутентифицирован или ошибка аутентификации
- `403`: Недостаточно прав
- `404`: Ресурс не найден
- `409`: Конфликт ресурсов

## Примеры использования

### 1. Регистрация пользователя
```bash
curl -X POST "/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "ivan_ivanov",
    "email": "ivan@example.com",
    "password": "securepassword123",
    "fullName": "Иван Иванов",
    "phone": "+79991234567"
  }'
```

### 2. Вход пользователя
```bash
curl -X POST "/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "ivan_ivanov",
    "password": "securepassword123"
  }'
```

### 3. Получение информации о текущем пользователе
```bash
curl -X GET "/api/users/me" \
  -H "Authorization: Bearer <ваш_jwt_токен>"
```

### 4. Получение всех пользователей (для администратора)
```bash
curl -X GET "/api/users" \
  -H "Authorization: Bearer <jwt_токен_администратора>"
```

## Важные замечания

1. Все чувствительные операции (удаление пользователей, получение списка всех пользователей и т.д.) требуют прав администратора
2. JWT токены необходимо хранить безопасно и не передавать третьим лицам
3. Пароль должен соответствовать минимальным требованиям длины (6 символов)
4. Длина имени пользователя должна быть от 3 до 50 символов
5. Полное имя не должно превышать 100 символов

